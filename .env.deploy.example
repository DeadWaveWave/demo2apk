# Demo2APK Docker Deployment Environment Variables
# 
# This file contains environment variables for Docker deployment.
# Copy this file to `.env` and modify as needed:
#   cp .env.deploy.example .env
#
# Then deploy with:
#   docker compose -f docker-compose.deploy.yml up -d

# =============================================================================
# Server Ports
# =============================================================================
# Frontend Web UI port (default: 80 for production)
FRONTEND_PORT=80

# API server port (default: 3000)
API_PORT=3000

# =============================================================================
# File Upload & Storage
# =============================================================================
# Maximum upload file size (50MB default)
MAX_FILE_SIZE=52428800

# File retention period in hours (APKs auto-deleted after this time)
FILE_RETENTION_HOURS=2

# =============================================================================
# Rate Limiting
# =============================================================================
# Enable rate limiting to prevent abuse
RATE_LIMIT_ENABLED=true

# Maximum requests per IP per time window
RATE_LIMIT_MAX=5

# Time window for rate limiting
RATE_LIMIT_WINDOW=1 hour

# =============================================================================
# Build Cleanup
# =============================================================================
# Delete Cordova/Capacitor work directories after build (recommended: true)
CLEANUP_BUILD_ARTIFACTS=true

# Enable periodic cleanup of old files (recommended: true)
FILE_CLEANUP_ENABLED=true

# How often to scan for expired files (in minutes)
FILE_CLEANUP_INTERVAL_MINUTES=30

# =============================================================================
# Worker Configuration
# =============================================================================
# Number of concurrent build jobs (adjust based on server resources)
# Recommended: 1 for <4GB RAM, 2 for 8GB RAM, 3+ for 16GB+ RAM
WORKER_CONCURRENCY=1

# =============================================================================
# PWA Publishing (Optional - New in v2.3.0)
# =============================================================================
# Enable PWA generation alongside APK builds
# Set to 'true' to allow users to optionally export PWA web apps
PWA_ENABLED=false

# PWA site storage directory (inside container)
# PWA_DIR=/app/builds/pwa-sites

# Your PWA domain suffix (optional)
# If set, PWA URLs will be: https://<siteId>.<PWA_HOST_SUFFIX>/
# Example: PWA_HOST_SUFFIX=pwa.yourdomain.com
# PWA_HOST_SUFFIX=

# PWA URL scheme (http or https)
# PWA_URL_SCHEME=https

# PWA retention period in hours (defaults to FILE_RETENTION_HOURS if not set)
# PWA_RETENTION_HOURS=

# =============================================================================
# Resource Limits (Docker Compose)
# =============================================================================
# API Server resource limits
API_MEMORY_LIMIT=2G
API_CPU_LIMIT=2

# Worker resource limits
# Recommended settings based on your server:
#   - 2-4GB RAM server: WORKER_MEMORY_LIMIT=2G, WORKER_CPU_LIMIT=2
#   - 8GB RAM server:   WORKER_MEMORY_LIMIT=4G, WORKER_CPU_LIMIT=3
#   - 16GB+ RAM server: WORKER_MEMORY_LIMIT=6G, WORKER_CPU_LIMIT=4
WORKER_MEMORY_LIMIT=2G
WORKER_MEMORY_MB=2048
WORKER_CPU_LIMIT=2

# =============================================================================
# Advanced Settings (Usually no need to change)
# =============================================================================
# Mock builds for testing (set to 'true' to skip actual Android builds)
# MOCK_BUILD=false
