# Demo2APK Environment Configuration

# =============================================================================
# Server Ports
# =============================================================================
FRONTEND_PORT=5173     # Web UI port
API_PORT=3000          # API server port
REDIS_PORT=6379        # Redis port

# =============================================================================
# Server Settings
# =============================================================================
NODE_ENV=development
HOST=0.0.0.0

# =============================================================================
# Redis
# =============================================================================
REDIS_URL=redis://localhost:6379

# =============================================================================
# Storage
# =============================================================================
BUILDS_DIR=./builds
UPLOADS_DIR=./uploads

# =============================================================================
# File Retention (in hours)
# =============================================================================
FILE_RETENTION_HOURS=2    # APKs & build artifacts auto-deleted after 2 hours

# =============================================================================
# Build Artifacts Cleanup
# =============================================================================
CLEANUP_BUILD_ARTIFACTS=true   # Whether to delete Cordova/Capacitor work dirs after build (APK 始终保留)
CLEANUP_UPLOADS_ON_COMPLETE=true   # Whether to delete uploaded inputs after each job

# =============================================================================
# Worker File Cleanup
# =============================================================================
FILE_CLEANUP_ENABLED=true          # Set to 'false' to disable periodic cleanup of old files
FILE_CLEANUP_INTERVAL_MINUTES=30   # How often the worker scans BUILDS_DIR/UPLOADS_DIR for expired files

# =============================================================================
# Rate Limiting
# =============================================================================
RATE_LIMIT_ENABLED=true   # Set to 'false' to disable (for dev/testing)
RATE_LIMIT_MAX=5          # Max requests per window (5 per hour)
RATE_LIMIT_WINDOW=1 hour  # Time window

# =============================================================================
# File Upload
# =============================================================================
MAX_FILE_SIZE=52428800    # 50MB in bytes

# =============================================================================
# Worker
# =============================================================================
WORKER_CONCURRENCY=2      # Number of concurrent build jobs
MOCK_BUILD=false          # Set to 'true' for testing without actual builds

# =============================================================================
# Optional: Android SDK (auto-detected if not set)
# =============================================================================
# ANDROID_HOME=/opt/android-sdk

# =============================================================================
# Optional: Gradle Cache
# =============================================================================
# GRADLE_USER_HOME=/root/.gradle

# =============================================================================
# Resource Limits (Docker Compose)
# =============================================================================
# API Server
API_MEMORY_LIMIT=1G
API_CPU_LIMIT=1

# Worker (Build Process)
# Recommended: 2G/2Core for <4GB RAM, 4G/3Core for 8GB RAM
WORKER_MEMORY_LIMIT=4G
WORKER_MEMORY_MB=4096   # Should match WORKER_MEMORY_LIMIT (in MB)
WORKER_CPU_LIMIT=3
